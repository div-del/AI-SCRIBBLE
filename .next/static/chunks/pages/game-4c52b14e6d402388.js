(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{134:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return s(2229)}])},2229:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return GamePage}});var a=s(5893),r=s(7294),n=s(4529),l=s(1559);let d=(0,n.Ue)()((0,l.n)(e=>({gameStarted:!1,currentRound:0,currentDrawer:null,players:[],scoreboard:[],messages:[],drawCommands:[],timeLeft:120,wordHint:"",finalRankings:[],isRoundActive:!1,startGame:t=>e(e=>{e.gameStarted=!0,e.players=[{id:"human",name:t,isAI:!1},{id:"gpt4o",name:"GPT-4o",isAI:!0,modelId:"openai/gpt-4o"},{id:"claude",name:"Claude 3.5",isAI:!0,modelId:"anthropic/claude-3-5-sonnet"},{id:"gemini",name:"Gemini 2.0",isAI:!0,modelId:"google/gemini-2.0-flash"},{id:"mistral",name:"Mistral Large",isAI:!0,modelId:"mistral/large-2"},{id:"deepseek",name:"DeepSeek",isAI:!0,modelId:"deepseek/deepseek-chat"}],e.scoreboard=e.players.map((e,t)=>({playerId:e.id,name:e.name,currentPoints:0,rank:t+1}))}),submitGuess:t=>e(e=>{}),addDrawCommand:t=>e(e=>{e.drawCommands.push(t)}),addMessage:t=>e(e=>{e.messages.push(t)}),updateScoreboard:t=>e(e=>{e.scoreboard=t}),setTimeLeft:t=>e(e=>{e.timeLeft=t}),setWordHint:t=>e(e=>{e.wordHint=t}),setCurrentRound:t=>e(e=>{e.currentRound=t}),setCurrentDrawer:t=>e(e=>{e.currentDrawer=t}),setIsRoundActive:t=>e(e=>{e.isRoundActive=t}),endGame:t=>e(e=>{e.finalRankings=t,e.gameStarted=!1}),resetGame:()=>e(e=>{e.gameStarted=!1,e.currentRound=0,e.currentDrawer=null,e.players=[],e.scoreboard=[],e.messages=[],e.drawCommands=[],e.timeLeft=120,e.wordHint="",e.finalRankings=[],e.isRoundActive=!1})})));var o=s(7642);let useSocket=()=>{let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!1),{startGame:n,submitGuess:l,addDrawCommand:i,addMessage:c,updateScoreboard:u,setTimeLeft:m,setWordHint:g,setCurrentRound:h,setCurrentDrawer:b,setIsRoundActive:f,endGame:p}=d();return(0,r.useEffect)(()=>{let e=(0,o.io)("http://localhost:3001");return e.on("connect",()=>{a(!0),console.log("Connected to backend")}),e.on("disconnect",()=>{a(!1),console.log("Disconnected from backend")}),e.on("round_start",e=>{h(e.round),b(e.drawer),m(e.timeLimit),g(e.wordHint),f(!0),d.getState().drawCommands=[]}),e.on("draw_command",e=>{i(e)}),e.on("guess_submitted",e=>{c({type:"guess",playerId:e.playerId,playerName:e.playerName,text:e.guess,timestamp:Date.now()})}),e.on("correct_guess",e=>{c({type:"correct",playerId:e.playerId,playerName:e.playerName,text:"Correct! +".concat(e.points," pts"),timestamp:Date.now()})}),e.on("scoreboard_update",e=>{u(e.scoreboard)}),e.on("round_end",e=>{f(!1),c({type:"system",playerId:"system",playerName:"System",text:"Round ".concat(e.round," ended. Word was: ").concat(e.word),timestamp:Date.now()})}),e.on("game_end",e=>{p(e.finalRankings)}),t(e),()=>{e.close()}},[]),{socket:e,isConnected:s,startGame:t=>{e&&(e.emit("start_game",{playerName:t}),n(t))},submitGuess:t=>{e&&(e.emit("submit_guess",{guess:t}),l(t))}}};var i=s(5379),c=s.n(i);function DrawingCanvas(e){let{commands:t}=e,s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!s.current)return;let e=s.current;e.innerHTML="",t.forEach((t,s)=>{let a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",t.data),a.setAttribute("stroke",t.color),a.setAttribute("stroke-width",t.strokeWidth.toString()),a.setAttribute("fill","none"),a.setAttribute("stroke-linecap","round"),a.setAttribute("stroke-linejoin","round"),a.style.strokeDasharray="1000",a.style.strokeDashoffset="1000",a.style.animation="drawPath ".concat(t.duration,"ms ease-in-out ").concat(100*s,"ms forwards"),e.appendChild(a)})},[t]),(0,a.jsxs)("div",{className:"jsx-6797ef6a17abd03f flex justify-center",children:[(0,a.jsx)("svg",{ref:s,width:"400",height:"400",viewBox:"0 0 400 400",className:"jsx-6797ef6a17abd03f border-2 border-gray-300 rounded-lg bg-white"}),(0,a.jsx)(c(),{id:"6797ef6a17abd03f",children:"@-webkit-keyframes drawPath{to{stroke-dashoffset:0}}@-moz-keyframes drawPath{to{stroke-dashoffset:0}}@-o-keyframes drawPath{to{stroke-dashoffset:0}}@keyframes drawPath{to{stroke-dashoffset:0}}"})]})}function GuessInput(e){let{onSubmit:t,isDisabled:s=!1}=e,[n,l]=(0,r.useState)(""),handleSubmit=()=>{let e=n.trim().toLowerCase();e&&!s&&(t(e),l(""))};return(0,a.jsxs)("div",{className:"flex gap-2 p-4 bg-white border-t border-gray-200",children:[(0,a.jsx)("input",{type:"text",value:n,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"===e.key&&handleSubmit()},placeholder:"Type your guess...",disabled:s,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"}),(0,a.jsx)("button",{onClick:handleSubmit,disabled:s||!n.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Guess"})]})}function ChatFeed(e){let{messages:t}=e,s=(0,r.useRef)(null);(0,r.useEffect)(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[t]);let getMessageStyle=e=>{switch(e){case"correct":return"text-green-600 font-semibold";case"system":return"text-blue-600 italic";default:return"text-gray-800"}};return(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)("div",{ref:s,className:"h-full overflow-y-auto p-4 space-y-2 bg-gray-50",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"text-sm ".concat(getMessageStyle(e.type)),children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.playerName,":"]})," ",e.text]},t))})})}function Scoreboard(e){let{entries:t,currentDrawerId:s}=e,r=[...t].sort((e,t)=>e.rank-t.rank);return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Scoreboard"}),(0,a.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 rounded ".concat(e.playerId===s?"bg-blue-100":"bg-gray-50"),children:[(0,a.jsxs)("span",{className:"font-medium",children:["#",e.rank," ",e.name]}),(0,a.jsxs)("span",{className:"text-gray-600",children:[e.currentPoints," pts"]})]},e.playerId))})]})}function GameTimer(e){let{timeLeft:t}=e;return(0,a.jsxs)("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-2",children:[(0,a.jsx)("div",{className:"h-4 rounded-full transition-all duration-1000 ".concat(t>60?"bg-green-500":t>30?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(t/120*100,"%")}}),(0,a.jsxs)("div",{className:"text-center text-2xl font-bold mt-2",children:[t,"s"]})]})}function RoundHeader(e){let{round:t,drawer:s,wordLength:r}=e;return(0,a.jsxs)("div",{className:"text-center mb-4",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-2",children:["Round ",t,"/6"]}),s&&(0,a.jsxs)("p",{className:"text-lg mb-2",children:[s.name," is drawing..."]}),(0,a.jsx)("p",{className:"text-xl font-mono bg-gray-100 p-2 rounded",children:"_ ".repeat(r).trim()})]})}let getRankEmoji=e=>{switch(e){case 1:return"\uD83E\uDD47";case 2:return"\uD83E\uDD48";case 3:return"\uD83E\uDD49";default:return"#".concat(e)}};function FinalRankingsModal(e){let{rankings:t,isOpen:s,onClose:r}=e;return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-center mb-4",children:"\uD83C\uDFC6 Final Rankings"}),(0,a.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[(0,a.jsxs)("span",{className:"font-medium",children:[getRankEmoji(e.rank)," ",e.name]}),(0,a.jsxs)("span",{className:"text-gray-600",children:[e.totalPoints," pts"]})]},e.playerId))}),(0,a.jsx)("button",{onClick:r,className:"w-full mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Play Again"})]})}):null}function GamePage(){let[e,t]=(0,r.useState)(""),{socket:s,isConnected:n,startGame:l,submitGuess:o}=useSocket(),{gameStarted:i,currentRound:c,currentDrawer:u,scoreboard:m,messages:g,drawCommands:h,timeLeft:b,wordHint:f,finalRankings:p,isRoundActive:x}=d();return i||0!==p.length?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100 p-4",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)(RoundHeader,{round:c,drawer:u,wordLength:f.split(" ").length}),(0,a.jsx)(GameTimer,{timeLeft:b}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(DrawingCanvas,{commands:h})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(Scoreboard,{entries:m,currentDrawerId:null==u?void 0:u.id}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow h-64",children:(0,a.jsx)(ChatFeed,{messages:g})}),(0,a.jsx)(GuessInput,{onSubmit:e=>{o(e)},isDisabled:!x||(null==u?void 0:u.isAI)===!1})]})]})]}),(0,a.jsx)(FinalRankingsModal,{rankings:p,isOpen:p.length>0,onClose:()=>{d.getState().resetGame()}})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-center mb-6",children:"AI Drawing Game"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter your name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("button",{onClick:()=>{e.trim()&&l(e.trim())},disabled:!e.trim()||!n,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:n?"Start Game":"Connecting..."})]})]})})}}},function(e){e.O(0,[142,774,888,179],function(){return e(e.s=134)}),_N_E=e.O()}]);